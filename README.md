# SCOPE-DEL

<!-- Replace the `src` below after you add your image to the repo -->

<p align="center">
  <img src="docs/assets/scope-del-logo.png" alt="SCOPE-DEL logo">
</p>

> Similarity & COverage Prioritization and Evaluation for DNA-Encoded Libraries (SCOPE-DEL): Notebooks, data, and results for GTM-driven chemography to prioritize DNA-Encoded Libraries (DELs) by balancing similarity and chemical-space coverage.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Package manager: PDM](https://img.shields.io/badge/packaging-PDM-blue.svg)](https://pdm.fming.dev)

---

## Table of contents

* [Repository structure](#repository-structure)
* [Quick start (PDM)](#quick-start-pdm)
* [Data](#data)
* [Reproducing figures & tables](#reproducing-figures--tables)
* [Results](#results)
* [Contributing](#contributing)
* [License](#license)
* [Acknowledgments](#acknowledgments)

---

## Repository structure

```
SCOPE-DEL/
├── notebooks/
│   ├── DataPreprocessing.ipynb           # Data curation & standardization
│   ├── GTM_GMM_optimization_benchmark.ipynb
│   └── Analysis_results.ipynb            # Metrics, comparisons, figure export
├── data/
│   ├── raw/                              # Input sources (unmodified)
│   └── processed/                        # Cleaned data ready for modeling
├── results/
│   ├── figures/                          # PNG/SVG plots & landscapes
│   └── tables/                           # CSV summaries & metrics
├── docs/
│   └── assets/
│       └── SCOPE-del-logo.png             # ← put your README image here
├── pyproject.toml                        # PDM project config
├── pdm.lock                              # Locked dependency graph (generated)
├── LICENSE                               # MIT
└── README.md
```

---

## Quick start (PDM)

> Requires **Python 3.10+** and **PDM 2.** If you don’t have PDM:
>
> ```bash
> pipx install pdm   # recommended
> # or: pip install -U pdm
> ```

1. **Create and activate the PDM virtualenv**

```bash
# inside the repo root
pdm venv create -i python3.10     # or your preferred interpreter
pdm use -f .venv/bin/python        # on Windows: .venv\Scripts\python.exe
```

2. **Install dependencies**

```bash
pdm install
```

> Notes:
>
> * RDKit wheels are platform-dependent. The project uses `rdkit`/`rdkit-pypi`. If installation fails on your OS, see RDKit’s wheel/conda guidance or switch the fingerprinting backend in the notebooks.

3. **Run the notebooks**

```bash
# (optional) register a Jupyter kernel named “SCOPE-del”
pdm run python -m ipykernel install --user --name SCOPE-del

# start Jupyter
pdm run jupyter lab     # or: pdm run jupyter notebook
```

4. **Recreate exports**

* Run `notebooks/DataPreprocessing.ipynb` to populate `data/processed/`.
* Run `notebooks/GTM_GMM_optimization_benchmark.ipynb` for GTM map selection.
* Run `notebooks/Analysis_results.ipynb` to produce figures/tables in `results/`.

**Handy commands**

```bash
# freeze dependencies for external runners/CI
pdm export -f requirements -o requirements.txt --without-hashes
# run quality tools if configured
pdm run black . && pdm run isort .
```

---

## Data

* `data/raw/` contains references (or instructions) for obtaining large sources not committed to the repo.
* `data/processed/` is generated by `DataPreprocessing.ipynb` (fingerprints, deduped sets, splits).
* For reproducibility, the preprocessing notebook documents exact retrieval, cleaning, and descriptor parameters.

---

## Reproducing figures & tables

`Analysis_results.ipynb` exports:

* Correlation heatmaps comparing GTM-space vs fingerprint-space metrics
* Coverage-vs-similarity scatter plots
* Density/class landscapes
* Summary CSVs with overlaps, EF\@k, and other selection metrics

Artifacts are written to `results/figures/` and `results/tables/` with filenames matching manuscript labels.

---

## Results

Key takeaways reproduced by the notebooks:

* GTM-derived, centroid-oriented metrics serve as practical proxies for pairwise fingerprint measures in DEL selection.
* Visual GTM landscapes help balance similarity to a reference with broader chemical-space coverage.

---

## Contributing

Issues and PRs are welcome. Please:

* Keep notebook outputs deterministic where possible.
* Note OS/Python/PDM versions when reporting issues.
* Discuss large additions (new DEL panels, alternative metrics, new GTM maps) in an issue first.

---

## License

This project is licensed under the **MIT License**. See [LICENSE](LICENSE) for details.

---

## Acknowledgments

Thanks to the manuscript authors and collaborators who contributed ideas, datasets, and early GTM utilities.

---

